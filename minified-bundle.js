(()=>{var p=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var g=p((A,u)=>{var F=e=>document.querySelector(e),S=e=>document.querySelectorAll(e);u.exports={$:F,$$:S}});var w=p((R,f)=>{async function k(e){return new Promise((t,i)=>{let n=new Image;n.onload=()=>{let r=.8,a=document.createElement("canvas");a.width=n.width,a.height=n.height,a.getContext("2d").drawImage(n,0,0,n.width,n.height);let l=()=>{a.toBlob(d=>{d.size/1048576<=3?t(d):r>.1?(r-=.1,a.toBlob(l,"image/webp",r)):i(new Error("Unable to compress image below 3 MB"))},"image/webp",r)};l()},n.onerror=()=>{i(new Error("Image loading error"))};let c=new FileReader;c.onload=r=>{n.src=r.target.result},c.onerror=()=>{i(new Error("FileReader error"))},c.readAsDataURL(e)})}f.exports.compressImage=k});var h=p((D,y)=>{async function C(e,o,s,t){let i="https://us-central1-enduring-maxim-411523.cloudfunctions.net/girlsock-directory_image-upload",n=await I(s);o+=".webp";let c=JSON.stringify({dir:e,fileName:o,imageContent:n,text:t});try{return await(await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:c})).clone()}catch(r){throw new Error(`Network error: ${r.message}`)}}function I(e){return new Promise((o,s)=>{let t=new FileReader;t.readAsDataURL(e),t.onload=()=>o(t.result.split(",")[1]),t.onerror=i=>s(i)})}y.exports.uploadSockToCloudFunction=C});var x=p((P,v)=>{function b(e){let o=E(e).split(".").pop().toLowerCase();return o||""}function E(e){return e.split("/").pop().split("#")[0].split("?")[0]}function L(e){return{"":"application/octet-stream",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",bmp:"image/bmp",tiff:"image/tiff",mp3:"audio/mpeg",wav:"audio/wav",mp4:"video/mp4",mov:"video/quicktime",pdf:"application/pdf",mpeg:"video/mpeg",mpga:"audio/mpeg",m4a:"audio/mp4",webm:"video/webm"}[b(e)]}v.exports={getLastExtension:b,getMimeTypeFromUri:L,getFileNameFromUri:E}});var{$:m,$$:O}=g(),{compressImage:T}=w(),{uploadSockToCloudFunction:U}=h(),{getUriExtension:j,getFileNameFromUri:B}=x();document.addEventListener("DOMContentLoaded",M);function M(){m("#post-form-submit").addEventListener("click",async function(e){e.preventDefault(),m("#post-form-submit-loading-modal").style.display="block",(await q()).ok&&(m("#post-form-submit-loading-modal").style.display="none")})}async function q(){let e=m("#post-image"),o=m("#post-body")?.value;if(e.files.length>0){let s=await T(e.files[0]),t=await U("/th/",B(e.files[0].name),s,o);return console.log(t.ok),t}}})();
//# sourceMappingURL=minified-bundle.js.map
